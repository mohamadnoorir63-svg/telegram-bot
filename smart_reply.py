import random
import re

# ======================= ๐ ุชุดุฎุต ุงุญุณุงุณ =======================
def detect_emotion(text: str) -> str:
    """ุชุญูู ุณุงุฏู ุงุญุณุงุณ ุฌููู ุจุฑุง ูุงฺฉูุด ุทุจุนโุชุฑ"""
    if not text:
        return "neutral"

    text = text.lower()

    happy = ["๐", "๐คฃ", "๐", "ุฎูุดุญุงูู", "ุนุงูู", "ุฏูุช ฺฏุฑู", "ุฎูุจู", "ูุฑุณ", "โค๏ธ"]
    sad = ["๐", "๐ข", "ุบูฺฏูู", "ุจุฏู ูุงุฏ", "ุฏูู ฺฏุฑูุชู", "ุงูุณุฑุฏู"]
    angry = ["๐ก", "ูุนูุช", "ุญุฑุตู", "ุนุตุจุงู", "ุจุฏุจุฎุช", "ุฎูู ุดู"]
    love = ["ุฏูุณุชุช ุฏุงุฑู", "โค๏ธ", "๐", "ุนุงุดูุชู", "ุนุดู", "ููุจู"]
    question = ["?", "ฺุฑุง", "ฺู", "ฺ ุดุฏ", "ฺฉุฌุง", "ฺฉุฌุง", "ฺุทูุฑ"]

    for w in happy:
        if w in text:
            return "happy"
    for w in sad:
        if w in text:
            return "sad"
    for w in angry:
        if w in text:
            return "angry"
    for w in love:
        if w in text:
            return "love"
    for w in question:
        if w in text:
            return "question"

    return "neutral"

# ======================= ๐ฌ ูพุงุณุฎ ููุดููุฏ =======================
def smart_response(text: str, emotion: str) -> str:
    """ูพุงุณุฎ ุณุงุฏู ู ุงูุณุงูโูุงููุฏ ุจุฑ ุงุณุงุณ ุงุญุณุงุณ ุชุดุฎุต ุฏุงุฏูโุดุฏู"""
    if not text:
        return ""

    responses = {
        "happy": [
            "๐ ุฎูุดุญุงูู ุญุงูุช ุฎูุจู!",
            "๐ ุจุฎูุฏ ฺฉู ุฏูุง ุจุฎูุฏู!",
            "๐ ฺู ุญุณ ุฎูุจ!",
        ],
        "sad": [
            "๐ข ูฺฏุฑุงู ูุจุงุดุ ุฏุฑุณุช ูุดู.",
            "๐ ููุดู ุจุนุฏ ุงุฒ ุดุจ ุชุงุฑฺฉุ ุตุจุญ ุฑูุดู ูุงุฏ.",
            "๐ ุฏูู ุจุฑุงุช ู ฺุง ุฏุงุบ ูโุฎูุงุฏ.",
        ],
        "angry": [
            "๐ค ุขุฑูู ุจุงุด ุฑูู...",
            "๐ก ูุฑ ฺ ุดุฏู ุงุฑุฒุด ุนุตุจ ุดุฏู ูุฏุงุฑู.",
            "๐ง ู ููุณ ุนูู ุจฺฉุด!",
        ],
        "love": [
            "โค๏ธ ููู ุงุฒ ุชู ุฎูุดู ูุงุฏ ๐ณ",
            "๐ ุง ุจุงุจุง ุฎุฌุงูุช ูฺฉุด ๐",
            "๐ ุนุดู ุชู ููุง ูพุฎุดู!",
        ],
        "question": [
            "๐ค ุณูุงู ุฎูุจูุ ุจุฒุงุฑ ูฺฉุฑ ฺฉูู...",
            "๐ ุณูุงู ุณุฎุชู ูู ุฌุงูุจู!",
            "๐ง ุณูุงู ุจุงุนุซ ุฑุดุฏ ุฐูู ูุดู!",
        ],
        "neutral": [
            "๐ ุฌุงูุจู...",
            "๐ถ ุจุงุดู...",
            "๐ ุญูู!",
            "๐ค ูู ฺฏูุด ูโุฏู...",
        ],
    }

    # ุงุญุชูุงู ณฐูช ุจุฑุง ูพุงุณุฎ ุฑูุฏูู ุงุฒ ููุฏ ุฎูุซ ุญุช ุงฺฏุฑ ุงุญุณุงุณ ูุดุฎุตู
    if random.random() < 0.3:
        emotion = "neutral"

    return random.choice(responses.get(emotion, responses["neutral"]))
